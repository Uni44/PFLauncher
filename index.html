<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PF Launcher</title>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@700;900&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --zzz-yellow: #ffda00;
            --zzz-pink: #ff69b4;
            --zzz-dark: #1a1a1a;
            --zzz-bg-glass: rgba(0, 0, 0, 0.6);
        }

        * { box-sizing: border-box; }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
            background: url('background.jpg') no-repeat center center;
            background-size: cover;
        }

        /* --- UI OVERLAY --- */
        .main-screen {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 40px;
            background: linear-gradient(to right, rgba(255,105,180, 0.1), transparent);
        }

        /* Barra Superior */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            -webkit-app-region: drag;
            z-index: 10;
        }

        .game-logo {
            font-family: 'Exo 2', sans-serif;
            font-weight: 900;
            font-size: 32px;
            color: white;
            text-transform: uppercase;
            letter-spacing: -2px;
        }

        .window-controls { -webkit-app-region: no-drag; }
        .window-controls button {
            background: none; border: none; color: white;
            font-size: 20px; cursor: pointer; padding: 5px 10px;
        }

        /* Secci√≥n Izquierda: Noticias */
        .left-content {
            margin-top: auto;
            margin-bottom: 20px;
            width: 350px;
            z-index: 5;
        }

        .news-panel {
            background: var(--zzz-bg-glass);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border-left: 5px solid var(--zzz-yellow);
        }

        .news-tabs { display: flex; gap: 15px; margin-bottom: 10px; font-weight: bold; }
        .news-tabs span { cursor: pointer; opacity: 0.6; }
        .news-tabs .active { opacity: 1; border-bottom: 2px solid var(--zzz-yellow); }

        .news-item {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        /* Secci√≥n Derecha Inferior: Bot√≥n de Inicio */
        .bottom-right {
            position: absolute;
            bottom: 40px;
            right: 40px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        #actionButton {
            background: var(--zzz-yellow);
            color: black;
            border: none;
            padding: 15px 60px;
            font-family: 'Exo 2', sans-serif;
            font-weight: 900;
            font-size: 24px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 0 20px rgba(255, 218, 0, 0.4);
            transition: transform 0.1s, background 0.2s;
        }

        #actionButton:hover { transform: scale(1.05); background: #fff; }
        #actionButton:active { transform: scale(0.95); }

        .btn-play-icon {
            background: black;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        /* Barra Lateral de Redes */
        .side-socials {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: rgba(255,255,255,0.1);
            padding: 15px 8px;
            border-radius: 30px;
            backdrop-filter: blur(5px);
        }

        .side-socials img { width: 24px; opacity: 0.8; cursor: pointer; }

        /* Consola de Log oculta o minimalista */
        .minimal-log {
            position: absolute;
            bottom: 120px;
            right: 40px;
            text-align: right;
            font-size: 12px;
            color: rgba(255,255,255,0.5);
        }

        .progress-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
        }
        #progress {
            width: 0%;
            height: 100%;
            background: var(--zzz-yellow);
            transition: width 0.3s;
        }
    </style>
</head>
<body>

<div class="main-screen">
    <div class="top-bar">
        <div class="game-logo">PF Launcher</div>
        <div class="window-controls">
            <button onclick="minimizar()">‚Äî</button>
            <button onclick="cerrar()">‚úï</button>
        </div>
    </div>

    <div class="side-socials">
        <span>üåê</span><span>üì±</span><span>üí¨</span><span>YT</span>
    </div>

    <div class="left-content">
        <div class="news-panel">
            <div class="news-tabs">
                <span class="active">Anuncios</span>
                <span>Noticias</span>
            </div>
            <div id="news-list">
                <div class="news-item"><span>Actualizaci√≥n de versi√≥n 2.6...</span> <span>02/04</span></div>
                <div class="news-item"><span>Evento ¬´Armon√≠a de delusiones¬ª</span> <span>02/04</span></div>
            </div>
        </div>
    </div>

    <div class="minimal-log" id="log">Sistema listo...</div>

    <div class="bottom-right">
        <button id="actionButton" onclick="descargar()">
            <div class="btn-play-icon">‚ñ∂</div>
            <span id="btnText">Comenzar juego</span>
        </button>
    </div>

    <div class="progress-container">
        <div id="progress"></div>
    </div>
</div>

<script>
    // Mantengo tu l√≥gica funcional original pero adaptada a los nuevos IDs
    let isDownloading = false;

    function log(msg) {
        document.getElementById("log").innerText = msg;
    }

    function setProgress(value) {
        document.getElementById("progress").style.width = value + "%";
    }

    async function descargar() {
        if (isDownloading) return;
        isDownloading = true;
        
        const btn = document.getElementById("actionButton");
        const btnText = document.getElementById("btnText");
        
        btn.style.opacity = "0.7";
        btnText.textContent = "Descargando...";
        log("Iniciando descarga...");

        try {
            let result = await window.pywebview.api.descargar_juego();
            setProgress(100);
            await setPlayMode();
        } catch (e) {
            log("Error: " + e);
        } finally {
            isDownloading = false;
            btn.style.opacity = "1";
        }
    }

    async function setPlayMode() {
        try {
            let data = await window.pywebview.api.verificar_estado();
            let state = JSON.parse(data);
            const btnText = document.getElementById("btnText");
            const btn = document.getElementById("actionButton");

            if (state.needs_update) {
                btnText.textContent = "Actualizar";
                btn.onclick = descargar;
            } else if (state.installed) {
                btnText.textContent = "Comenzar juego";
                btn.onclick = async () => {
                    log("Abriendo...");
                    await window.pywebview.api.abrir_juego();
                };
            }
        } catch(e) { console.error(e); }
    }

    // Funciones de ventana
    function minimizar() { window.pywebview.api.minimizar(); }
    function cerrar() { window.pywebview.api.cerrar(); }

    window.addEventListener('pywebviewready', setPlayMode);
</script>

</body>
</html>